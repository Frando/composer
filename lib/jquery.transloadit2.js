/*
 jQuery Easing v1.3: Copyright (c) 2008 George McGinley Smith | BSD License: http://www.opensource.org/licenses/bsd-license.php
 jQuery JSONP Core Plugin 2.1.2: Copyright (c) 2010 Julian Aubourg | MIT License: http://www.opensource.org/licenses/mit-license.php
 json2: Douglas Crockford | Public domain
 jQuery Tools 1.2.3: Tero Piirainen | Public domain
 jquery.transloadit2.js: Copyright (c) 2010 Felix Geisend√∂rfer | MIT License: http://www.opensource.org/licenses/mit-license.php

 Fork this on Github: http://github.com/transloadit/jquery-sdk
*/
jQuery.easing.jswing=jQuery.easing.swing;
jQuery.extend(jQuery.easing,{def:"easeOutQuad",swing:function(c,a,f,e,g){return jQuery.easing[jQuery.easing.def](c,a,f,e,g)},easeInQuad:function(c,a,f,e,g){return e*(a/=g)*a+f},easeOutQuad:function(c,a,f,e,g){return-e*(a/=g)*(a-2)+f},easeInOutQuad:function(c,a,f,e,g){if((a/=g/2)<1)return e/2*a*a+f;return-e/2*(--a*(a-2)-1)+f},easeInCubic:function(c,a,f,e,g){return e*(a/=g)*a*a+f},easeOutCubic:function(c,a,f,e,g){return e*((a=a/g-1)*a*a+1)+f},easeInOutCubic:function(c,a,f,e,g){if((a/=g/2)<1)return e/
2*a*a*a+f;return e/2*((a-=2)*a*a+2)+f},easeInQuart:function(c,a,f,e,g){return e*(a/=g)*a*a*a+f},easeOutQuart:function(c,a,f,e,g){return-e*((a=a/g-1)*a*a*a-1)+f},easeInOutQuart:function(c,a,f,e,g){if((a/=g/2)<1)return e/2*a*a*a*a+f;return-e/2*((a-=2)*a*a*a-2)+f},easeInQuint:function(c,a,f,e,g){return e*(a/=g)*a*a*a*a+f},easeOutQuint:function(c,a,f,e,g){return e*((a=a/g-1)*a*a*a*a+1)+f},easeInOutQuint:function(c,a,f,e,g){if((a/=g/2)<1)return e/2*a*a*a*a*a+f;return e/2*((a-=2)*a*a*a*a+2)+f},easeInSine:function(c,
a,f,e,g){return-e*Math.cos(a/g*(Math.PI/2))+e+f},easeOutSine:function(c,a,f,e,g){return e*Math.sin(a/g*(Math.PI/2))+f},easeInOutSine:function(c,a,f,e,g){return-e/2*(Math.cos(Math.PI*a/g)-1)+f},easeInExpo:function(c,a,f,e,g){return a==0?f:e*Math.pow(2,10*(a/g-1))+f},easeOutExpo:function(c,a,f,e,g){return a==g?f+e:e*(-Math.pow(2,-10*a/g)+1)+f},easeInOutExpo:function(c,a,f,e,g){if(a==0)return f;if(a==g)return f+e;if((a/=g/2)<1)return e/2*Math.pow(2,10*(a-1))+f;return e/2*(-Math.pow(2,-10*--a)+2)+f},
easeInCirc:function(c,a,f,e,g){return-e*(Math.sqrt(1-(a/=g)*a)-1)+f},easeOutCirc:function(c,a,f,e,g){return e*Math.sqrt(1-(a=a/g-1)*a)+f},easeInOutCirc:function(c,a,f,e,g){if((a/=g/2)<1)return-e/2*(Math.sqrt(1-a*a)-1)+f;return e/2*(Math.sqrt(1-(a-=2)*a)+1)+f},easeInElastic:function(c,a,f,e,g){c=1.70158;var b=0,d=e;if(a==0)return f;if((a/=g)==1)return f+e;b||(b=g*0.3);if(d<Math.abs(e)){d=e;c=b/4}else c=b/(2*Math.PI)*Math.asin(e/d);return-(d*Math.pow(2,10*(a-=1))*Math.sin((a*g-c)*2*Math.PI/b))+f},easeOutElastic:function(c,
a,f,e,g){c=1.70158;var b=0,d=e;if(a==0)return f;if((a/=g)==1)return f+e;b||(b=g*0.3);if(d<Math.abs(e)){d=e;c=b/4}else c=b/(2*Math.PI)*Math.asin(e/d);return d*Math.pow(2,-10*a)*Math.sin((a*g-c)*2*Math.PI/b)+e+f},easeInOutElastic:function(c,a,f,e,g){c=1.70158;var b=0,d=e;if(a==0)return f;if((a/=g/2)==2)return f+e;b||(b=g*0.3*1.5);if(d<Math.abs(e)){d=e;c=b/4}else c=b/(2*Math.PI)*Math.asin(e/d);if(a<1)return-0.5*d*Math.pow(2,10*(a-=1))*Math.sin((a*g-c)*2*Math.PI/b)+f;return d*Math.pow(2,-10*(a-=1))*Math.sin((a*
g-c)*2*Math.PI/b)*0.5+e+f},easeInBack:function(c,a,f,e,g,b){if(b==undefined)b=1.70158;return e*(a/=g)*a*((b+1)*a-b)+f},easeOutBack:function(c,a,f,e,g,b){if(b==undefined)b=1.70158;return e*((a=a/g-1)*a*((b+1)*a+b)+1)+f},easeInOutBack:function(c,a,f,e,g,b){if(b==undefined)b=1.70158;if((a/=g/2)<1)return e/2*a*a*(((b*=1.525)+1)*a-b)+f;return e/2*((a-=2)*a*(((b*=1.525)+1)*a+b)+2)+f},easeInBounce:function(c,a,f,e,g){return e-jQuery.easing.easeOutBounce(c,g-a,0,e,g)+f},easeOutBounce:function(c,a,f,e,g){return(a/=
g)<1/2.75?e*7.5625*a*a+f:a<2/2.75?e*(7.5625*(a-=1.5/2.75)*a+0.75)+f:a<2.5/2.75?e*(7.5625*(a-=2.25/2.75)*a+0.9375)+f:e*(7.5625*(a-=2.625/2.75)*a+0.984375)+f},easeInOutBounce:function(c,a,f,e,g){if(a<g/2)return jQuery.easing.easeInBounce(c,a*2,0,e,g)*0.5+f;return jQuery.easing.easeOutBounce(c,a*2-g,0,e,g)*0.5+e*0.5+f}});
(function(c,a){function f(){}function e(l){F=[l]}function g(l,y,z){return l&&l.apply(y.context||y,z)}function b(l){function y(o){!A++&&a(function(){C();D&&(G[t]={s:[o]});J&&(o=J.apply(l,[o]));g(l.success,l,[o,n]);g(K,l,[l,n])},0)}function z(o){!A++&&a(function(){C();D&&o!=L&&(G[t]=o);g(l.error,l,[l,o]);g(K,l,[l,o])},0)}l=c.extend({},M,l);var K=l.complete,J=l.dataFilter,N=l.callbackParameter,O=l.callback,T=l.cache,D=l.pageCache,P=l.charset,t=l.url,w=l.data,Q=l.timeout,E,A=0,C=f;l.abort=function(){!A++&&
C()};if(g(l.beforeSend,l,[l])===false||A)return l;t=t||p;w=w?typeof w=="string"?w:c.param(w,l.traditional):p;t+=w?(/\?/.test(t)?"&":"?")+w:p;N&&(t+=(/\?/.test(t)?"&":"?")+escape(N)+"=?");!T&&!D&&(t+=(/\?/.test(t)?"&":"?")+"_"+(new Date).getTime()+"=");t=t.replace(/=\?(&|$)/,"="+O+"$1");D&&(E=G[t])?E.s?y(E.s[0]):z(E):a(function(o,B,H){if(!A){H=Q>0&&a(function(){z(L)},Q);C=function(){H&&clearTimeout(H);o[v]=o[k]=o[s]=o[m]=null;x[u](o);B&&x[u](B)};window[O]=e;o=c(r)[0];o.id=q+U++;if(P)o[j]=P;var R=function(I){(o[k]||
f)();I=F;F=undefined;I?y(I[0]):z(h)};if(S.msie){o.event=k;o.htmlFor=o.id;o[v]=function(){o.readyState=="loaded"&&R()}}else{o[m]=o[s]=R;S.opera?(B=c(r)[0]).text="jQuery('#"+o.id+"')[0]."+m+"()":o[d]=d}o.src=t;x.insertBefore(o,x.firstChild);B&&x.insertBefore(B,x.firstChild)}},0);return l}var d="async",j="charset",p="",h="error",q="_jqjsp",k="onclick",m="on"+h,s="onload",v="onreadystatechange",u="removeChild",r="<script/>",n="success",L="timeout",S=c.browser,x=c("head")[0]||document.documentElement,
G={},U=0,F,M={callback:q,url:location.href};b.setup=function(l){c.extend(M,l)};c.jsonp=b})(jQuery,setTimeout);if(!this.JSON)this.JSON={};
(function(){function c(h){return h<10?"0"+h:h}function a(h){g.lastIndex=0;return g.test(h)?'"'+h.replace(g,function(q){var k=j[q];return typeof k==="string"?k:"\\u"+("0000"+q.charCodeAt(0).toString(16)).slice(-4)})+'"':'"'+h+'"'}function f(h,q){var k,m,s,v,u=b,r,n=q[h];if(n&&typeof n==="object"&&typeof n.toJSON==="function")n=n.toJSON(h);if(typeof p==="function")n=p.call(q,h,n);switch(typeof n){case "string":return a(n);case "number":return isFinite(n)?String(n):"null";case "boolean":case "null":return String(n);
case "object":if(!n)return"null";b+=d;r=[];if(Object.prototype.toString.apply(n)==="[object Array]"){v=n.length;for(k=0;k<v;k+=1)r[k]=f(k,n)||"null";s=r.length===0?"[]":b?"[\n"+b+r.join(",\n"+b)+"\n"+u+"]":"["+r.join(",")+"]";b=u;return s}if(p&&typeof p==="object"){v=p.length;for(k=0;k<v;k+=1){m=p[k];if(typeof m==="string")if(s=f(m,n))r.push(a(m)+(b?": ":":")+s)}}else for(m in n)if(Object.hasOwnProperty.call(n,m))if(s=f(m,n))r.push(a(m)+(b?": ":":")+s);s=r.length===0?"{}":b?"{\n"+b+r.join(",\n"+b)+
"\n"+u+"}":"{"+r.join(",")+"}";b=u;return s}}if(typeof Date.prototype.toJSON!=="function"){Date.prototype.toJSON=function(){return isFinite(this.valueOf())?this.getUTCFullYear()+"-"+c(this.getUTCMonth()+1)+"-"+c(this.getUTCDate())+"T"+c(this.getUTCHours())+":"+c(this.getUTCMinutes())+":"+c(this.getUTCSeconds())+"Z":null};String.prototype.toJSON=Number.prototype.toJSON=Boolean.prototype.toJSON=function(){return this.valueOf()}}var e=/[\u0000\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g,
g=/[\\\"\x00-\x1f\x7f-\x9f\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g,b,d,j={"\u0008":"\\b","\t":"\\t","\n":"\\n","\u000c":"\\f","\r":"\\r",'"':'\\"',"\\":"\\\\"},p;if(typeof JSON.stringify!=="function")JSON.stringify=function(h,q,k){var m;d=b="";if(typeof k==="number")for(m=0;m<k;m+=1)d+=" ";else if(typeof k==="string")d=k;if((p=q)&&typeof q!=="function"&&(typeof q!=="object"||typeof q.length!=="number"))throw Error("JSON.stringify");return f("",
{"":h})};if(typeof JSON.parse!=="function")JSON.parse=function(h,q){function k(s,v){var u,r,n=s[v];if(n&&typeof n==="object")for(u in n)if(Object.hasOwnProperty.call(n,u)){r=k(n,u);if(r!==undefined)n[u]=r;else delete n[u]}return q.call(s,v,n)}var m;h=String(h);e.lastIndex=0;if(e.test(h))h=h.replace(e,function(s){return"\\u"+("0000"+s.charCodeAt(0).toString(16)).slice(-4)});if(/^[\],:{}\s]*$/.test(h.replace(/\\(?:["\\\/bfnrt]|u[0-9a-fA-F]{4})/g,"@").replace(/"[^"\\\n\r]*"|true|false|null|-?\d+(?:\.\d*)?(?:[eE][+\-]?\d+)?/g,
"]").replace(/(?:^|:|,)(?:\s*\[)+/g,""))){m=eval("("+h+")");return typeof q==="function"?k({"":m},""):m}throw new SyntaxError("JSON.parse");}})();
(function(c){function a(){if(c.browser.msie){var h=c(document).height(),q=c(window).height();return[window.innerWidth||document.documentElement.clientWidth||document.body.clientWidth,h-q<20?q:h]}return[c(document).width(),c(document).height()]}function f(h){if(h)return h.call(c.mask)}c.tools=c.tools||{version:"1.2.3"};var e;e=c.tools.expose={conf:{maskId:"exposeMask",loadSpeed:"slow",closeSpeed:"fast",closeOnClick:true,closeOnEsc:true,zIndex:9998,opacity:0.8,startOpacity:0,color:"#fff",onLoad:null,
onClose:null}};var g,b,d,j,p;c.mask={load:function(h,q){if(d)return this;if(typeof h=="string")h={color:h};h=h||j;j=h=c.extend(c.extend({},e.conf),h);g=c("#"+h.maskId);if(!g.length){g=c("<div/>").attr("id",h.maskId);c("body").append(g)}var k=a();g.css({position:"absolute",top:0,left:0,width:k[0],height:k[1],display:"none",opacity:h.startOpacity,zIndex:h.zIndex});h.color&&g.css("backgroundColor",h.color);if(f(h.onBeforeLoad)===false)return this;h.closeOnEsc&&c(document).bind("keydown.mask",function(m){m.keyCode==
27&&c.mask.close(m)});h.closeOnClick&&g.bind("click.mask",function(m){c.mask.close(m)});c(window).bind("resize.mask",function(){c.mask.fit()});if(q&&q.length){p=q.eq(0).css("zIndex");c.each(q,function(){var m=c(this);/relative|absolute|fixed/i.test(m.css("position"))||m.css("position","relative")});b=q.css({zIndex:Math.max(h.zIndex+1,p=="auto"?0:p)})}g.css({display:"block"}).fadeTo(h.loadSpeed,h.opacity,function(){c.mask.fit();f(h.onLoad)});d=true;return this},close:function(){if(d){if(f(j.onBeforeClose)===
false)return this;g.fadeOut(j.closeSpeed,function(){f(j.onClose);b&&b.css({zIndex:p})});c(document).unbind("keydown.mask");g.unbind("click.mask");c(window).unbind("resize.mask");d=false}return this},fit:function(){if(d){var h=a();g.css({width:h[0],height:h[1]})}},getMask:function(){return g},isLoaded:function(){return d},getConf:function(){return j},getExposed:function(){return b}};c.fn.mask=function(h){c.mask.load(h);return this};c.fn.expose=function(h){c.mask.load(h,this);return this}})(jQuery);
(function(c){function a(){this.timer=this.documentTitle=this.instance=this.assemblyId=null;this._options={};this.uploads=[];this.results={};this.pollStarted=this.ended=null;this.seq=this.pollRetries=0;this.started=false;this.params=this.assembly=null;this.lastPoll=this.bytesReceivedBefore=0;this.$modal=this.$iframe=this.$fileClones=this.$files=this.$form=this.$params=null}var f=document.location.protocol=="https:"?"https://":"http://",e={service:f+"api2.transloadit.com/",assets:f+"assets.transloadit.com/",
onStart:function(){},onProgress:function(){},onUpload:function(){},onResult:function(){},onCancel:function(){},onError:function(){},onSuccess:function(){},interval:2500,wait:false,autoSubmit:true,modal:true,exclude:"",fields:false,debug:true},g=false;c.fn.transloadit=function(){var b=Array.prototype.slice.call(arguments),d;if(b.length==1&&typeof b[0]=="object"||b[0]===undefined)b.unshift("init");d=b.shift();if(d=="init"){uploader=new a;b.unshift(this);this.data("transloadit.uploader",uploader)}else uploader=
this.data("transloadit.uploader");if(!uploader)throw Error("Element is not initialized for transloadit!");b=uploader[d].apply(uploader,b);return b===undefined?this:b};a.prototype.init=function(b,d){this.$form=b;this.options(c.extend({},e,d||{}));var j=this;b.bind("submit.transloadit",function(){j.getBoredInstance();return false});this.includeCss()};a.prototype.getBoredInstance=function(){var b=this;this.instance=null;c.jsonp({url:this._options.service+"instances/bored",timeout:6E3,callbackParameter:"callback",
success:function(d){if(d.error){b.ended=true;b.renderError(d);b._options.onError(d)}else{b.instance=d.api2_host;b.start()}},error:function(d,j){b.ended=true;var p={error:"CONNECTION_ERROR",message:"There was a problem connecting to the upload server",reason:"JSONP request status: "+j};b.renderError(p);b._options.onError(p)}});this._options.modal&&this.showModal()};a.prototype.start=function(){var b=this;this.ended=this.started=false;this.seq=this.pollRetries=this.bytesReceivedBefore=0;this.uploads=
[];this.results={};this.assemblyId=this.uuid();var d=this.$form.find("input[name=params]");if(d.length){try{this.params=JSON.parse(d.val())}catch(j){alert("Error: input[name=params] seems to contain invalid JSON.");return}if(this.params.redirect_url)this.$form.attr("action",this.params.redirect_url);else if(this._options.autoSubmit&&this.$form.attr("action")==this._options.service+"assemblies"){alert("Error: input[name=params] does not include a redirect_url");return}this.$files=this.$form.find("input[type=file]").not(this._options.exclude);
b.$fileClones=c().not(document);this.$files.each(function(){var h=c(this).clone();b.$fileClones=b.$fileClones.add(h);h.insertAfter(this)});this.$iframe=c('<iframe id="transloadit-'+this.assemblyId+'" name="transloadit-'+this.assemblyId+'"/>').appendTo("body").hide();this.$uploadForm=c('<form enctype="multipart/form-data" />').attr("action",f+this.instance+"/assemblies/"+this.assemblyId+"?redirect=false").attr("target","transloadit-"+this.assemblyId).attr("method","POST").append(this.$files).appendTo("body").hide();
var p="[name=params], [name=signature]";if(this._options.fields===true)p="*";else if(typeof this._options.fields=="string")p+=", "+this._options.fields;this.$form.find(":input[type!=file]").filter(p).clone().prependTo(this.$uploadForm);this.$params=d;this.$uploadForm.submit();this.lastPoll=+new Date;setTimeout(function(){b._poll()},300)}else alert("Could not find input[name=params] in your form.")};a.prototype._poll=function(b){var d=this;if(!this.ended){if(c.browser.mozilla&&!this.documentTitle){this.documentTitle=
document.title;document.title="Loading..."}this.pollStarted=+new Date;c.jsonp({url:f+this.instance+"/assemblies/"+this.assemblyId+(b||"?seq="+this.seq),timeout:6E3,callbackParameter:"callback",success:function(j){if(!d.ended){d.assembly=j;if(j.error=="ASSEMBLY_NOT_FOUND"){d.pollRetries++;if(d.pollRetries>15){document.title=d.documentTitle;d.ended=true;d.renderError(j);d._options.onError(j)}else setTimeout(function(){d._poll()},400)}else if(j.error){d.ended=true;d.renderError(j);document.title=d.documentTitle;
d._options.onError(j)}else{d.seq=j.last_seq;if(!d.started){d.started=true;d._options.onStart(j)}d.pollRetries=0;var p=j.ok=="ASSEMBLY_EXECUTING",h=j.ok=="ASSEMBLY_CANCELED",q=j.ok=="ASSEMBLY_COMPLETED";d._options.onProgress(j.bytes_received,j.bytes_expected,j);for(var k=0;k<j.uploads.length;k++){d._options.onUpload(j.uploads[k],j);d.uploads.push(j.uploads[k])}for(var m in j.results){d.results[m]=d.results[m]||[];for(k=0;k<j.results[m].length;k++){d._options.onResult(m,j.results[m][k],j);d.results[m].push(j.results[m][k])}}if(h){d.ended=
true;document.title=d.documentTitle;d._options.onCancel(j)}else{d.renderProgress(j);if(q||!d._options.wait&&p){d.ended=true;document.title=d.documentTitle;j.uploads=d.uploads;j.results=d.results;d._options.onSuccess(j);d._options.modal&&d.cancel();d._options.autoSubmit&&d.submitForm()}else{j=d.pollStarted-+new Date;d.timer=setTimeout(function(){d._poll()},j<d._options.interval?d._options.interval:j);d.lastPoll=+new Date}}}}},error:function(j,p){if(!d.ended){d.pollRetries++;if(d.pollRetries>3){document.title=
d.documentTitle;d.ended=true;var h={error:"CONNECTION_ERROR",message:"There was a problem connecting to the upload server",reason:"JSONP request status: "+p};d.renderError(h);d._options.onError(h)}else setTimeout(function(){d._poll()},350)}}})}};a.prototype.stop=function(){document.title=this.documentTitle;this.ended=true};a.prototype.cancel=function(){if(!this.ended){var b=this;this.$params.prependTo(this.$form);this.$fileClones.each(function(d){d=c(b.$files[d]);var j=c(this);d.insertAfter(j);j.remove()});
clearTimeout(b.timer);this._poll("?method=delete");this.$iframe[0].contentWindow.stop();setTimeout(function(){b.$iframe.remove()},500)}if(this._options.modal){c.mask.close();this.$modal.remove()}};a.prototype.submitForm=function(){this.$fileClones.remove();c("<textarea/>").attr("name","transloadit").text(JSON.stringify(this.assembly)).prependTo(this.$form).hide();this.$form.unbind("submit.transloadit").submit()};a.prototype.showModal=function(){this.$modal=c('<div id="transloadit"><div class="content"><a href="#close" class="close"></a><p class="status"></p><div class="progress"><label>starting upload ...</label><span></span></div><p class="error"></p></div></div>').appendTo("body");
c.extend(this.$modal,{$status:this.$modal.find(".status"),$content:this.$modal.find(".content"),$close:this.$modal.find(".close"),$label:this.$modal.find("label"),$progress:this.$modal.find(".progress"),$progressSpan:this.$modal.find(".progress span"),$error:this.$modal.find(".error")});var b=this;this.$modal.$close.click(function(){b.cancel()});this.$modal.$error.hide();b=this;this.$modal.expose({api:true,maskId:"transloadit_expose",opacity:0.9,loadSpeed:250,closeOnEsc:false,closeOnClick:false}).load();
this.$modal.$close.click(function(){b.cancel();return false})};a.prototype.renderError=function(b){if(this._options.modal){this.$modal.$content.addClass("content-error");this.$modal.$progress.hide();this.$modal.$error.html(this._options.debug?b.error+": "+b.message+"<br><br>"+(b.reason||""):"There was an internal error, please try your upload again.").show()}};a.prototype.renderProgress=function(b){if(this._options.modal){var d=b.bytes_received/b.bytes_expected,j=b.bytes_received-this.bytesReceivedBefore,
p=+new Date-this.lastPoll,h=d==1?1E3:this._options.interval*2;j=d==1?"processing ...":(b.bytes_received/1024/1024).toFixed(2)+" MB / "+(b.bytes_expected/1024/1024).toFixed(2)+" MB ("+(j/1024/(p/1E3)).toFixed(1)+" kB / sec)";this.bytesReceivedBefore=b.bytes_received;this.$modal.$label.text(j);this.$modal.$progressSpan.stop().animate({width:d*100+"%"},h,"easeOutCubic")}};a.prototype.includeCss=function(){if(!(g||!this._options.modal)){g=true;c('<link rel="stylesheet" type="text/css" href="'+this._options.assets+
'css/transloadit2.css" />').appendTo("head")}};a.prototype.uuid=function(){var b="";for(i=0;i<32;i++)b+=Math.floor(Math.random()*16).toString(16);return b};a.prototype.options=function(b){if(arguments.length==0)return this._options;c.extend(this._options,b)};a.prototype.option=function(b,d){if(arguments.length==1)return this._options[b];this._options[b]=d}})(jQuery);